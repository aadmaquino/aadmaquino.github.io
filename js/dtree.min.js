function Node(a,b,c,d,e,f,g,h){this.id=a,this.pid=b,this.name=c,this.url=d,this.title=e,this.target=f,this.img=h,this._io=g||!1,this._ls=!1,this._hc=!1,this._is=!1}function dTree(a){this.arrNodes=[],this.arrRecursed=[],this.arrIcons=[],this.rootNode=-1,this.strOutput="",this.selectedNode=null,this.instanceName=a,this.imgFolder="../img/",this.target=null,this.hasLines=!0,this.clickSelect=!0,this.folderLinks=!0,this.useCookies=!0,this.add=function(a,b,c,d,e,f,g,h){this.arrNodes[this.arrNodes.length]=new Node(a,b,c,d,e,f,g,h)},this.draw=function(){document.getElementById?(this.preloadIcons(),this.useCookies&&(this.selectedNode=this.getSelected()),this.addNode(this.rootNode),document.writeln(this.strOutput)):document.writeln("Browser not supported.")},this.openAll=function(){this.oAll(!0)},this.closeAll=function(){this.oAll(!1)},this.preloadIcons=function(){this.hasLines?(this.arrIcons[0]=new Image,this.arrIcons[0].src=this.imgFolder+"plus.gif",this.arrIcons[1]=new Image,this.arrIcons[1].src=this.imgFolder+"plusbottom.gif",this.arrIcons[2]=new Image,this.arrIcons[2].src=this.imgFolder+"minus.gif",this.arrIcons[3]=new Image,this.arrIcons[3].src=this.imgFolder+"minusbottom.gif"):(this.arrIcons[0]=new Image,this.arrIcons[0].src=this.imgFolder+"nolines_plus.gif",this.arrIcons[1]=new Image,this.arrIcons[1].src=this.imgFolder+"nolines_plus.gif",this.arrIcons[2]=new Image,this.arrIcons[2].src=this.imgFolder+"nolines_minus.gif",this.arrIcons[3]=new Image,this.arrIcons[3].src=this.imgFolder+"nolines_minus.gif"),this.arrIcons[4]=new Image,this.arrIcons[4].src=this.imgFolder+"folder.gif",this.arrIcons[5]=new Image,this.arrIcons[5].src=this.imgFolder+"folderopen.gif"},this.addNode=function(a){for(var b=0;b<this.arrNodes.length;b++)if(this.arrNodes[b].pid==a){var c=this.arrNodes[b];if(c._hc=this.hasChildren(c),c._ls=!!this.hasLines&&this.lastSibling(c),c._hc&&!c._io&&this.useCookies&&(c._io=this.isOpen(c.id)),this.clickSelect&&c.id==this.selectedNode&&(c._is=!0,this.selectedNode=b),!this.folderLinks&&c._hc&&(c.url=null),this.rootNode!=c.pid){for(r=0;r<this.arrRecursed.length;r++)this.strOutput+='<img src="'+this.imgFolder+(1==this.arrRecursed[r]&&this.hasLines?"line":"empty")+'.gif" alt="" />';c._ls?this.arrRecursed.push(0):this.arrRecursed.push(1),c._hc?(this.strOutput+='<a href="javascript: '+this.instanceName+".o("+b+');"><img id="j'+this.instanceName+b+'" src="'+this.imgFolder,this.hasLines||(this.strOutput+="nolines_"),this.strOutput+=(c._io?c._ls&&this.hasLines?"minusbottom":"minus":c._ls&&this.hasLines?"plusbottom":"plus")+'.gif" alt="" /></a>'):this.strOutput+='<img src="'+this.imgFolder+(this.hasLines?c._ls?"joinbottom":"join":"empty")+'.gif" alt="" />'}c.url&&(this.strOutput+='<a href="'+c.url+'"',c.title&&(this.strOutput+=' title="'+c.title+'"'),c.target&&(this.strOutput+=' target="'+c.target+'"'),this.target&&!c.target&&(this.strOutput+=' target="'+this.target+'"'),this.clickSelect&&(c._hc?this.folderLinks&&(this.strOutput+=' onclick="javascript: '+this.instanceName+".s("+b+');"'):this.strOutput+=' onclick="javascript: '+this.instanceName+".s("+b+');"'),this.strOutput+=">"),this.folderLinks&&c.url||!c._hc||c.pid==this.rootNode||(this.strOutput+='<a href="javascript: '+this.instanceName+".o("+b+');">'),this.strOutput+='<img id="i'+this.instanceName+b+'" src="'+this.imgFolder,this.strOutput+=c.img?c.img:(this.rootNode==c.pid?"base":c._hc?c._io?"folderopen":"folder":"page")+".gif",this.strOutput+='" alt="" />',this.strOutput+='<span id="s'+this.instanceName+b+'" class="'+(this.clickSelect&&c._is?"nodeSel":"node")+'">',this.strOutput+=c.name,this.strOutput+="</span>",(c.url||!this.folderLinks&&c._hc)&&(this.strOutput+="</a>"),this.strOutput+="<br />\n",c._hc&&(this.strOutput+='<div id="d'+this.instanceName+b+'" style="display:'+(this.rootNode==c.pid||c._io?"block":"none")+';">\n',this.addNode(c.id),this.strOutput+="</div>\n"),this.arrRecursed.pop()}},this.hasChildren=function(a){for(n=0;n<this.arrNodes.length;n++)if(this.arrNodes[n].pid==a.id)return!0;return!1},this.lastSibling=function(a){var b;for(n=0;n<this.arrNodes.length;n++)this.arrNodes[n].pid==a.pid&&(b=this.arrNodes[n].id);return b==a.id},this.isOpen=function(a){for(openNodes=this.getCookie("co"+this.instanceName).split("."),n=0;n<openNodes.length;n++)if(openNodes[n]==a)return!0;return!1},this.isSelected=function(a){return selectedNode=this.getCookie("cs"+this.instanceName),!(!selectedNode||a!=selectedNode)&&(this.selectedNode=a,!0)},this.getSelected=function(){return selectedNode=this.getCookie("cs"+this.instanceName),selectedNode?selectedNode:null},this.s=function(a){cn=this.arrNodes[a],this.selectedNode!=a&&(this.selectedNode&&(eOldSpan=document.getElementById("s"+this.instanceName+this.selectedNode),eOldSpan.className="node"),eNewSpan=document.getElementById("s"+this.instanceName+a),eNewSpan.className="nodeSel",this.selectedNode=a,this.useCookies&&this.setCookie("cs"+this.instanceName,cn.id))},this.o=function(a){cn=this.arrNodes[a],cn._io?this.nodeClose(a,cn._ls):this.nodeOpen(a,cn._ls),cn._io=!cn._io,this.useCookies&&this.updateCookie()},this.oAll=function(a){for(n=0;n<this.arrNodes.length;n++)this.arrNodes[n]._hc&&this.arrNodes[n].pid!=this.rootNode&&(a?(this.nodeOpen(n,this.arrNodes[n]._ls),this.arrNodes[n]._io=!0):(this.nodeClose(n,this.arrNodes[n]._ls),this.arrNodes[n]._io=!1));this.useCookies&&this.updateCookie()},this.nodeOpen=function(a,b){eDiv=document.getElementById("d"+this.instanceName+a),eJoin=document.getElementById("j"+this.instanceName+a),eIcon=document.getElementById("i"+this.instanceName+a),eJoin.src=b?this.arrIcons[3].src:this.arrIcons[2].src,this.arrNodes[a].img||(eIcon.src=this.arrIcons[5].src),eDiv.style.display="block"},this.nodeClose=function(a,b){eDiv=document.getElementById("d"+this.instanceName+a),eJoin=document.getElementById("j"+this.instanceName+a),eIcon=document.getElementById("i"+this.instanceName+a),eJoin.src=b?this.arrIcons[1].src:this.arrIcons[0].src,this.arrNodes[a].img||(eIcon.src=this.arrIcons[4].src),eDiv.style.display="none"},this.clearCookie=function(){var a=new Date,b=new Date(a.getTime()-864e5);this.setCookie("co"+this.instanceName,"cookieValue",b),this.setCookie("cs"+this.instanceName,"cookieValue",b)},this.setCookie=function(a,b,c,d,e,f){document.cookie=escape(a)+"="+escape(b)+(c?"; expires="+c.toGMTString():"")+(d?"; path="+d:"")+(e?"; domain="+e:"")+(f?"; secure":"")},this.getCookie=function(a){var b="",c=document.cookie.indexOf(escape(a)+"=");if(c!=-1){var d=c+(escape(a)+"=").length,e=document.cookie.indexOf(";",d);b=e!=-1?unescape(document.cookie.substring(d,e)):unescape(document.cookie.substring(d))}return b},this.updateCookie=function(){for(sReturn="",n=0;n<this.arrNodes.length;n++)this.arrNodes[n]._io&&this.arrNodes[n].pid!=this.rootNode&&(sReturn&&(sReturn+="."),sReturn+=this.arrNodes[n].id);this.setCookie("co"+this.instanceName,sReturn)}}Array.prototype.push||(Array.prototype.push=function(){for(var b=0;b<arguments.length;b++)this[this.length]=arguments[b];return this.length}),Array.prototype.pop||(Array.prototype.pop=function(){return lastElement=this[this.length-1],this.length=Math.max(this.length-1,0),lastElement});